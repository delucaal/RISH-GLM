function [fa,T_] = tensor2fa_vec(dd)


a=dd(1,:)';
b=dd(2,:)';
c=dd(3,:)';
d=dd(4,:)';
e=dd(5,:)';
f=dd(6,:)';

T_ = a./3 + d./3 + f./3;
 
fa=(2.^(1/2).*3.^(1/2).*(2.*abs(b).^2 + 2.*abs(c).^2 + 2.*abs(e).^2 + abs(a./3 + d./3 - (2.*f)./3).^2 + ...
    abs(a./3 - (2.*d)./3 + f./3).^2 + abs(d./3 - (2.*a)./3 + f./3).^2).^(1/2))./(2.*(abs(a).^2 + ...
    2.*abs(b).^2 + 2.*abs(c).^2 + abs(d).^2 + 2.*abs(e).^2 + abs(f).^2).^(1/2));
